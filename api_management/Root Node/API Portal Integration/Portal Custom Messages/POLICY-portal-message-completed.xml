<?xml version="1.0" encoding="UTF-8"?>
<wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <wsp:All wsp:Usage="Required">
        <L7p:AuditDetailAssertion>
            <L7p:Detail stringValue="Policy Fragment: message-completed-policy,${request.shared.portal.analytics.api.uuid}"/>
            <L7p:Enabled booleanValue="false"/>
        </L7p:AuditDetailAssertion>
        <wsp:OneOrMore wsp:Usage="Required">
            <wsp:All wsp:Usage="Required">
                <L7p:ComparisonAssertion>
                    <L7p:CaseSensitive booleanValue="false"/>
                    <L7p:Expression1 stringValue="${request.shared.portal.analytics.api.uuid}"/>
                    <L7p:Operator operatorNull="null"/>
                    <L7p:Predicates predicates="included">
                        <L7p:item dataType="included">
                            <L7p:Type variableDataType="string"/>
                        </L7p:item>
                        <L7p:item stringLength="included">
                            <L7p:Max intValue="-1"/>
                            <L7p:Min intValue="36"/>
                        </L7p:item>
                    </L7p:Predicates>
                </L7p:ComparisonAssertion>
                <L7p:ComparisonAssertion>
                    <L7p:CaseSensitive booleanValue="false"/>
                    <L7p:Expression1 stringValue="${gateway.portal.analytics.datalake.hostname}"/>
                    <L7p:Operator operatorNull="null"/>
                    <L7p:Predicates predicates="included">
                        <L7p:item dataType="included">
                            <L7p:Type variableDataType="string"/>
                        </L7p:item>
                        <L7p:item binary="included">
                            <L7p:Operator operator="NE"/>
                            <L7p:RightValue stringValue="not installed"/>
                        </L7p:item>
                    </L7p:Predicates>
                </L7p:ComparisonAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="${request.completed} - convert &quot;true&quot;, &quot;false&quot; value to &quot;1&quot;, 0&quot;."/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue=""/>
                    <L7p:VariableToSet stringValue="isRequestCompleted"/>
                </L7p:SetVariable>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${request.completed}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="boolean"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="true"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="MQ=="/>
                            <L7p:VariableToSet stringValue="isRequestCompleted"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${request.completed}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="boolean"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="false"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="MA=="/>
                            <L7p:VariableToSet stringValue="isRequestCompleted"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <L7p:TrueAssertion/>
                </wsp:OneOrMore>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="${request.authorized} - convert &quot;true&quot;, &quot;false&quot; value to &quot;1&quot;, 0&quot;."/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue=""/>
                    <L7p:VariableToSet stringValue="isRequestAuthorized"/>
                </L7p:SetVariable>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${request.authorized}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="boolean"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="true"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="MQ=="/>
                            <L7p:VariableToSet stringValue="isRequestAuthorized"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${request.authorized}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="boolean"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="false"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="MA=="/>
                            <L7p:VariableToSet stringValue="isRequestAuthorized"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <L7p:TrueAssertion/>
                </wsp:OneOrMore>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="Retrieve organization name, account plan ID, account plan name, application name, and quota."/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5wb3J0YWwuYW5hbHl0aWNzLm9yZ2FuaXphdGlvbi51dWlkfQ=="/>
                    <L7p:VariableToSet stringValue="organizationId"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5wb3J0YWwuYW5hbHl0aWNzLm9yZ2FuaXphdGlvbi5uYW1lfQ=="/>
                    <L7p:VariableToSet stringValue="organizationName"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5hY2NvdW50UGxhbklkfQ=="/>
                    <L7p:VariableToSet stringValue="accountPlanId"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5hY2NvdW50UGxhbk5hbWV9"/>
                    <L7p:VariableToSet stringValue="accountPlanName"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5wb3J0YWwuYW5hbHl0aWNzLmFwcGxpY2F0aW9uLm5hbWV9"/>
                    <L7p:VariableToSet stringValue="applicationName"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue=""/>
                    <L7p:VariableToSet stringValue="quotaDaily"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue=""/>
                    <L7p:VariableToSet stringValue="quotaMonthly"/>
                </L7p:SetVariable>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:CommentAssertion>
                            <L7p:Comment stringValue="Daily Quota"/>
                        </L7p:CommentAssertion>
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${request.shared.timeUnit}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="int"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:RightValue stringValue="4"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5xdW90YX0="/>
                            <L7p:VariableToSet stringValue="quotaDaily"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:CommentAssertion>
                            <L7p:Comment stringValue="Monthly Quota"/>
                        </L7p:CommentAssertion>
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${request.shared.timeUnit}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="int"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:RightValue stringValue="5"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5xdW90YX0="/>
                            <L7p:VariableToSet stringValue="quotaMonthly"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <L7p:TrueAssertion/>
                </wsp:OneOrMore>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtzZXJ2aWNlLm5hbWV9"/>
                    <L7p:VariableToSet stringValue="apiName"/>
                </L7p:SetVariable>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="Retrieve response code and routing total time. If not set, default to 0."/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="MA=="/>
                    <L7p:VariableToSet stringValue="responseCode"/>
                </L7p:SetVariable>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${isRequestCompleted}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="0"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="NTAw"/>
                            <L7p:VariableToSet stringValue="responseCode"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${isRequestAuthorized}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="0"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="NDAx"/>
                            <L7p:VariableToSet stringValue="responseCode"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${responseCode}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="0"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${request.shared.portal.analytics.response.code}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                </L7p:item>
                                <L7p:item stringLength="included">
                                    <L7p:Max intValue="-1"/>
                                    <L7p:Min intValue="1"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5wb3J0YWwuYW5hbHl0aWNzLnJlc3BvbnNlLmNvZGV9"/>
                            <L7p:VariableToSet stringValue="responseCode"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <L7p:TrueAssertion/>
                </wsp:OneOrMore>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="MA=="/>
                    <L7p:VariableToSet stringValue="routingTotalTime"/>
                </L7p:SetVariable>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${request.shared.portal.analytics.routingTotalTime}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                </L7p:item>
                                <L7p:item stringLength="included">
                                    <L7p:Max intValue="-1"/>
                                    <L7p:Min intValue="1"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5wb3J0YWwuYW5hbHl0aWNzLnJvdXRpbmdUb3RhbFRpbWV9"/>
                            <L7p:VariableToSet stringValue="routingTotalTime"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <L7p:TrueAssertion/>
                </wsp:OneOrMore>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="Escape double quote with double quote."/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:Regex>
                    <L7p:AutoTarget booleanValue="false"/>
                    <L7p:IncludeEntireExpressionCapture booleanValue="false"/>
                    <L7p:OtherTargetMessageVariable stringValue="accountPlanName"/>
                    <L7p:Regex stringValue="&quot;"/>
                    <L7p:RegexVar stringValue="accountPlanName"/>
                    <L7p:Replace booleanValue="true"/>
                    <L7p:Replacement stringValue="&quot;&quot;"/>
                    <L7p:Target target="OTHER"/>
                </L7p:Regex>
                <L7p:Regex>
                    <L7p:AutoTarget booleanValue="false"/>
                    <L7p:IncludeEntireExpressionCapture booleanValue="false"/>
                    <L7p:OtherTargetMessageVariable stringValue="organizationName"/>
                    <L7p:Regex stringValue="&quot;"/>
                    <L7p:RegexVar stringValue="organizationName"/>
                    <L7p:Replace booleanValue="true"/>
                    <L7p:Replacement stringValue="&quot;&quot;"/>
                    <L7p:Target target="OTHER"/>
                </L7p:Regex>
                <L7p:Regex>
                    <L7p:AutoTarget booleanValue="false"/>
                    <L7p:IncludeEntireExpressionCapture booleanValue="false"/>
                    <L7p:OtherTargetMessageVariable stringValue="applicationName"/>
                    <L7p:Regex stringValue="&quot;"/>
                    <L7p:RegexVar stringValue="applicationName"/>
                    <L7p:Replace booleanValue="true"/>
                    <L7p:Replacement stringValue="&quot;&quot;"/>
                    <L7p:Target target="OTHER"/>
                </L7p:Regex>
                <L7p:Regex>
                    <L7p:AutoTarget booleanValue="false"/>
                    <L7p:IncludeEntireExpressionCapture booleanValue="false"/>
                    <L7p:OtherTargetMessageVariable stringValue="apiName"/>
                    <L7p:Regex stringValue="&quot;"/>
                    <L7p:RegexVar stringValue="apiName"/>
                    <L7p:Replace booleanValue="true"/>
                    <L7p:Replacement stringValue="&quot;&quot;"/>
                    <L7p:Target target="OTHER"/>
                </L7p:Regex>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="${applicationName} - empty value."/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${applicationName}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                </L7p:item>
                                <L7p:item stringLength="included"/>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="dW5hdXRob3JpemVk"/>
                            <L7p:VariableToSet stringValue="applicationName"/>
                        </L7p:SetVariable>
                    </wsp:All>
                    <L7p:TrueAssertion/>
                </wsp:OneOrMore>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="Calculate elapsed time"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnNoYXJlZC5wb3J0YWwuc3RhcnRTZXJ2aWNlfQ=="/>
                    <L7p:VariableToSet stringValue="requestStart"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtnYXRld2F5LnRpbWUubWlsbGlzfQ=="/>
                    <L7p:VariableToSet stringValue="now"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="PGVtcHR5Lz4="/>
                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                    <L7p:DataType variableDataType="message"/>
                    <L7p:VariableToSet stringValue="emptyMessage"/>
                </L7p:SetVariable>
                <L7p:ResponseXpathAssertion>
                    <L7p:VariablePrefix stringValue="calcElapsedTime"/>
                    <L7p:XmlMsgSrc stringValue="emptyMessage"/>
                    <L7p:XpathExpression xpathExpressionValue="included">
                        <L7p:Expression stringValue="$now - $requestStart"/>
                        <L7p:Namespaces mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="s"/>
                                <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                            </L7p:entry>
                        </L7p:Namespaces>
                        <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                    </L7p:XpathExpression>
                </L7p:ResponseXpathAssertion>
                <L7p:Regex>
                    <L7p:AutoTarget booleanValue="false"/>
                    <L7p:CaptureVar stringValue="elapsedTime"/>
                    <L7p:OtherTargetMessageVariable stringValue="calcElapsedTime.result"/>
                    <L7p:Regex stringValue="[0-9]*"/>
                    <L7p:Replacement stringValue=""/>
                    <L7p:Target target="OTHER"/>
                </L7p:Regex>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="Add metric to buffer."/>
                </L7p:CommentAssertion>
                <L7p:CommentAssertion>
                    <L7p:Comment stringValue="========================================"/>
                </L7p:CommentAssertion>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="IiR7cmVxdWVzdC50aW1lLm1pbGxpc30iLCIke2dhdGV3YXkucG9ydGFsLmNvbmZpZy5ub2RlLmlkfSIsIiR7Z2F0ZXdheS5wb3J0YWwuY29uZmlnLmlkZW50aWZpZXJ9IiwiJHtnYXRld2F5LnBvcnRhbC5jb25maWcubmFtZX0iLCIke2FjY291bnRQbGFuSWR9IiwiJHthY2NvdW50UGxhbk5hbWV9IiwiJHtyZXF1ZXN0LnNoYXJlZC5wb3J0YWwuYW5hbHl0aWNzLm9yZ2FuaXphdGlvbi51dWlkfSIsIiR7b3JnYW5pemF0aW9uTmFtZX0iLCIke3JlcXVlc3Quc2hhcmVkLnBvcnRhbC5hbmFseXRpY3MuYXBwbGljYXRpb24udXVpZH0iLCIke2FwcGxpY2F0aW9uTmFtZX0iLCIke3JlcXVlc3Quc2hhcmVkLnBvcnRhbC5hbmFseXRpY3MuYXBpLnV1aWR9IiwiJHthcGlOYW1lfSIsIiR7cXVvdGFEYWlseX0iLCIke3F1b3RhTW9udGhseX0iLCIke3JlcXVlc3Quc2hhcmVkLnBvcnRhbC5hbmFseXRpY3MuYXV0aFR5cGV9IiwiJHtzZXJ2aWNlLm9pZH0iLCIke3JlcXVlc3QudGNwLnJlbW90ZUlwfSIsIiR7cmVxdWVzdC5odHRwLm1ldGhvZH0iLCIke3JlcXVlc3Quc2hhcmVkLnBvcnRhbC5hbmFseXRpY3MuYWN0aW9ufSIsIiR7cmVzcG9uc2VDb2RlfSIsIiR7aXNSZXF1ZXN0Q29tcGxldGVkfSIsIiR7aXNSZXF1ZXN0QXV0aG9yaXplZH0iLCIke2VsYXBzZWRUaW1lfSIsIiR7cm91dGluZ1RvdGFsVGltZX0iLCIke3JlcXVlc3Quc2l6ZX0iLCIke3Jlc3BvbnNlLnNpemV9IiwiJHtyZXF1ZXN0LmF1dGhlbnRpY2F0ZWRVc2VyLmlkfSIsIiR7cmVxdWVzdC5hdXRoZW50aWNhdGVkVXNlci5sb2dpbn0iDQo="/>
                    <L7p:VariableToSet stringValue="csv"/>
                </L7p:SetVariable>
                <L7p:BufferData>
                    <L7p:BufferName stringValue="gooddata-metrics"/>
                    <L7p:MaxSizeBytes longValue="499122176"/>
                    <L7p:NewDataVarName stringValue="csv"/>
                </L7p:BufferData>
                <L7p:AuditDetailAssertion>
                    <L7p:Detail stringValue="buffer.wasFull = ${buffer.wasFull}buffer.wasExtrated = ${buffer.wasExtracted}buffer.newSize.bytes = ${buffer.newSize.bytes}buffer.newAge.millis = ${buffer.newAge.millis}"/>
                    <L7p:Level stringValue="FINEST"/>
                </L7p:AuditDetailAssertion>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${buffer.wasExtracted}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="boolean"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="false"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:AuditDetailAssertion>
                            <L7p:Detail stringValue="Metrics data successfully added to buffer."/>
                            <L7p:Level stringValue="FINEST"/>
                        </L7p:AuditDetailAssertion>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:CaseSensitive booleanValue="false"/>
                            <L7p:Expression1 stringValue="${buffer.wasExtracted}"/>
                            <L7p:Operator operatorNull="null"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item dataType="included">
                                    <L7p:Type variableDataType="boolean"/>
                                </L7p:item>
                                <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="true"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:AuditDetailAssertion>
                            <L7p:Detail stringValue="Unexpected error. Buffer was extracted."/>
                            <L7p:Level stringValue="WARNING"/>
                        </L7p:AuditDetailAssertion>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:AuditDetailAssertion>
                            <L7p:Detail stringValue="Unexpected error."/>
                            <L7p:Level stringValue="WARNING"/>
                        </L7p:AuditDetailAssertion>
                    </wsp:All>
                </wsp:OneOrMore>
            </wsp:All>
            <L7p:TrueAssertion/>
        </wsp:OneOrMore>
    </wsp:All>
</wsp:Policy>