<?xml version="1.0" encoding="UTF-8"?>
<wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <wsp:All wsp:Usage="Required">
        <wsp:All wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="LAC-PolicyType=inject"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="Component version 1.0.00 installed by LACApiGateway installer version lacgw1.0.00"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="=== Configuration of all endpoints that are used in LAC Project"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="**************** ADJUST DEFAULT CONFIGURATION ****************"/>
            </L7p:CommentAssertion>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="**************** API Gateway Inbound Protocol: HTTPS ****************"/>
            </L7p:CommentAssertion>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="aHR0cHM="/>
                <L7p:VariableToSet stringValue="project.forwarded.httpScheme"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="ODQ0Mw=="/>
                <L7p:VariableToSet stringValue="project.forwarded.port"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="Y2R2MWR2YXBpZ3dpbjAx"/>
                <L7p:VariableToSet stringValue="project.forwarded.hostname"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="cHJvZHVjdE5hbWU="/>
                <L7p:VariableToSet stringValue="project.name"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="djE="/>
                <L7p:VariableToSet stringValue="project.version"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="MTAuNDkuMjIuMTk="/>
                <L7p:VariableToSet stringValue="project.endpoint.hostname"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="ODA4MQ=="/>
                <L7p:VariableToSet stringValue="project.endpoint.port"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="aHR0cHM="/>
                <L7p:VariableToSet stringValue="project.endpoint.httpScheme"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Requires Configuration"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="cmVzdC9kZWZhdWx0"/>
                <L7p:VariableToSet stringValue="project.rootPath"/>
            </L7p:SetVariable>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="**************** ADJUST DEFAULT CONFIGURATION ****************"/>
            </L7p:CommentAssertion>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="JHtnYXRld2F5LmNsdXN0ZXIuaG9zdG5hbWV9"/>
                <L7p:VariableToSet stringValue="project.gateway.hostname"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="LyR7cHJvamVjdC5uYW1lfS8ke3Byb2plY3QudmVyc2lvbn0="/>
                <L7p:VariableToSet stringValue="project.gateway.basepath"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="aG9zdD0iJHtwcm9qZWN0LmZvcndhcmRlZC5ob3N0bmFtZX06JHtwcm9qZWN0LmZvcndhcmRlZC5wb3J0fSI7IHByb3RvPSR7cHJvamVjdC5mb3J3YXJkZWQuaHR0cFNjaGVtZX07IGNhLWxhYy1iYXNlcGF0aD0iJHtwcm9qZWN0LmdhdGV3YXkuYmFzZXBhdGh9Ig=="/>
                <L7p:VariableToSet stringValue="project.gateway.forwardedHeaderValues"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="JHtnYXRld2F5LmNsdXN0ZXIuaG9zdG5hbWV9"/>
                <L7p:VariableToSet stringValue="project.helpUrl.endpoint.hostname"/>
            </L7p:SetVariable>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="=== Configuration of the SwaggerValidation"/>
            </L7p:CommentAssertion>
            <L7p:SetVariable>
                <L7p:AssertionComment assertionComment="included">
                    <L7p:Properties mapValue="included">
                        <L7p:entry>
                            <L7p:key stringValue="RIGHT.COMMENT"/>
                            <L7p:value stringValue="Seconds"/>
                        </L7p:entry>
                    </L7p:Properties>
                </L7p:AssertionComment>
                <L7p:Base64Expression stringValue="NjA="/>
                <L7p:DataType variableDataType="int"/>
                <L7p:VariableToSet stringValue="project.swaggerCacheExpiry"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnVybC5wcm90b2NvbH06Ly8ke3Byb2plY3QuZW5kcG9pbnQuaG9zdG5hbWV9OiR7cHJvamVjdC5lbmRwb2ludC5wb3J0fS8ke3Byb2plY3Qucm9vdFBhdGh9LyR7cHJvamVjdC5uYW1lfS8ke3Byb2plY3QudmVyc2lvbn0="/>
                <L7p:VariableToSet stringValue="project.swaggerDocumentRoot"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="JHtwcm9qZWN0LnN3YWdnZXJEb2N1bWVudFJvb3R9L0Bkb2Nz"/>
                <L7p:VariableToSet stringValue="project.serviceSwaggerURL"/>
            </L7p:SetVariable>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="=== Configuration of the Role Mapper Groups and Roles"/>
            </L7p:CommentAssertion>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="c2ltcGxl"/>
                <L7p:VariableToSet stringValue="project.roleMappingType"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="QVBJIERvY3VtZW50YXRpb24="/>
                <L7p:VariableToSet stringValue="project.simpleRoleMapping.defaultRole"/>
            </L7p:SetVariable>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" **************** UPDATE TO MAP USERS (IF DESIRED)  ****************"/>
            </L7p:CommentAssertion>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="PHVzZXJzPg0KCTx1c2VyIGlkPSJjcnNlcHVsdmVkYSI+PGdyb3VwPkRldmVsb3BlcjwvZ3JvdXA+DQoJCTxncm91cD5Eb2N1bWVudGF0aW9uPC9ncm91cD4NCgk8L3VzZXI+DQo8L3VzZXJzPg=="/>
                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                <L7p:DataType variableDataType="message"/>
                <L7p:VariableToSet stringValue="project.simpleRoleMapper.users"/>
            </L7p:SetVariable>
            <L7p:CommentAssertion>
                <L7p:Comment stringValue=" **************** UPDATE TO MAP ROLES (IF DESIRED) ****************"/>
            </L7p:CommentAssertion>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="PHVzZXJSb2xlcz4NCgk8dXNlclJvbGUgZ3JvdXA9IkRldmVsb3BlciI+DQoJCTxyb2xlPkFQSSBPd25lcjwvcm9sZT4NCgk8L3VzZXJSb2xlPg0KCTx1c2VyUm9sZSBncm91cD0iU3VwcG9ydCI+DQoJCTxyb2xlPkFQSSBVc2VyPC9yb2xlPg0KCQk8cm9sZT5BUEkgT3duZXI8L3JvbGU+DQoJPC91c2VyUm9sZT4NCgk8dXNlclJvbGUgZ3JvdXA9IkRvY3VtZW50YXRpb24iPg0KCQk8cm9sZT5BUEkgRG9jdW1lbnRhdGlvbjwvcm9sZT4NCgk8L3VzZXJSb2xlPg0KPC91c2VyUm9sZXM+"/>
                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                <L7p:DataType variableDataType="message"/>
                <L7p:VariableToSet stringValue="project.simpleRoleMapper.userRoles"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCiAgICA8Y29uZmlnVmFyaWFibGVzIFVzYWdlPSJSZXF1aXJlZCI+DQogICAgICAgIDxTZXRWYXJpYWJsZT4NCiAgICAgICAgICAgIDxWYXJpYWJsZVRvU2V0IHN0cmluZ1ZhbHVlPSIke3Byb2plY3QuZm9yd2FyZGVkLmh0dHBTY2hlbWV9Ii8+DQogICAgICAgIDwvU2V0VmFyaWFibGU+DQogICAgICAgIDxTZXRWYXJpYWJsZT4NCiAgICAgICAgICAgIDxWYXJpYWJsZVRvU2V0IHN0cmluZ1ZhbHVlPSIke3Byb2plY3QuZm9yd2FyZGVkLnBvcnR9Ii8+DQogICAgICAgIDwvU2V0VmFyaWFibGU+DQogICAgICAgIDxTZXRWYXJpYWJsZT4NCiAgICAgICAgICAgIDxWYXJpYWJsZVRvU2V0IHN0cmluZ1ZhbHVlPSIke3Byb2plY3QuZm9yd2FyZGVkLmhvc3RuYW1lfSIvPg0KICAgICAgICA8L1NldFZhcmlhYmxlPg0KICAgICAgICA8U2V0VmFyaWFibGU+DQogICAgICAgICAgICA8VmFyaWFibGVUb1NldCBzdHJpbmdWYWx1ZT0iJHtwcm9qZWN0Lm5hbWV9Ii8+DQogICAgICAgIDwvU2V0VmFyaWFibGU+DQogICAgICAgIDxTZXRWYXJpYWJsZT4NCiAgICAgICAgICAgIDxWYXJpYWJsZVRvU2V0IHN0cmluZ1ZhbHVlPSIke3Byb2plY3QudmVyc2lvbn0iLz4NCiAgICAgICAgPC9TZXRWYXJpYWJsZT4NCiAgICAgICAgPFNldFZhcmlhYmxlPg0KICAgICAgICAgICAgPFZhcmlhYmxlVG9TZXQgc3RyaW5nVmFsdWU9IiR7cHJvamVjdC5lbmRwb2ludC5ob3N0bmFtZX0iLz4NCiAgICAgICAgPC9TZXRWYXJpYWJsZT4NCiAgICAgICAgPFNldFZhcmlhYmxlPg0KICAgICAgICAgICAgPFZhcmlhYmxlVG9TZXQgc3RyaW5nVmFsdWU9IiR7cHJvamVjdC5lbmRwb2ludC5wb3J0fSIvPg0KICAgICAgICA8L1NldFZhcmlhYmxlPg0KICAgICAgICA8U2V0VmFyaWFibGU+DQogICAgICAgICAgICA8VmFyaWFibGVUb1NldCBzdHJpbmdWYWx1ZT0iJHtwcm9qZWN0LmVuZHBvaW50Lmh0dHBTY2hlbWV9Ii8+DQogICAgICAgIDwvU2V0VmFyaWFibGU+DQogICAgICAgIDxTZXRWYXJpYWJsZT4NCiAgICAgICAgICAgIDxWYXJpYWJsZVRvU2V0IHN0cmluZ1ZhbHVlPSIke3Byb2plY3Qucm9vdFBhdGh9Ii8+DQogICAgICAgIDwvU2V0VmFyaWFibGU+DQogICAgPC9jb25maWdWYXJpYWJsZXM+"/>
                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                <L7p:DataType variableDataType="message"/>
                <L7p:VariableToSet stringValue="validateConfiguration"/>
            </L7p:SetVariable>
            <wsp:OneOrMore wsp:Usage="Required">
                <L7p:SchemaValidation>
                    <L7p:OtherTargetMessageVariable stringValue="validateConfiguration"/>
                    <L7p:ResourceInfo staticResourceInfo="included">
                        <L7p:Document stringValueReference="inline"><![CDATA[<?xml version="1.0"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" attributeFormDefault="unqualified" elementFormDefault="qualified">
  <xs:element name="configVariables" type="configVariablesType"/>
  <xs:complexType name="VariableToSetType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="stringValue" use="required">
        <xs:simpleType>
        <xs:restriction base="xs:string">
          <xs:minLength value = "1"/>
        </xs:restriction>
      </xs:simpleType>
      </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="SetVariableType">
    <xs:sequence>
      <xs:element type="VariableToSetType" name="VariableToSet"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="configVariablesType">
    <xs:sequence>
      <xs:element type="SetVariableType" name="SetVariable" maxOccurs="unbounded" minOccurs="0"/>
    </xs:sequence>
    <xs:attribute type="xs:string" name="Usage"/>
  </xs:complexType>
</xs:schema>]]></L7p:Document>
                    </L7p:ResourceInfo>
                    <L7p:Target target="OTHER"/>
                </L7p:SchemaValidation>
                <wsp:All wsp:Usage="Required">
                    <L7p:CustomizeErrorResponse>
                        <L7p:Content stringValueReference="inline"><![CDATA[{
	"statusCode": "500",
	"errorCode": "000",
	"errorMessage": "Service Misconfigured",
	"helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                        <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                        <L7p:ExtraHeaders nameValuePairArray="included"/>
                    </L7p:CustomizeErrorResponse>
                    <L7p:FalseAssertion/>
                </wsp:All>
            </wsp:OneOrMore>
            <L7p:ExportVariables>
                <L7p:ExportedVars stringArrayValue="included">
                    <L7p:item stringValue="project.endpoint.hostname"/>
                    <L7p:item stringValue="project.endpoint.httpScheme"/>
                    <L7p:item stringValue="project.endpoint.port"/>
                    <L7p:item stringValue="project.forwarded.hostname"/>
                    <L7p:item stringValue="project.forwarded.httpScheme"/>
                    <L7p:item stringValue="project.forwarded.port"/>
                    <L7p:item stringValue="project.gateway.basepath"/>
                    <L7p:item stringValue="project.gateway.forwardedHeaderValues"/>
                    <L7p:item stringValue="project.gateway.hostname"/>
                    <L7p:item stringValue="project.helpUrl.endpoint.hostname"/>
                    <L7p:item stringValue="project.name"/>
                    <L7p:item stringValue="project.roleMappingType"/>
                    <L7p:item stringValue="project.rootPath"/>
                    <L7p:item stringValue="project.serviceSwaggerURL"/>
                    <L7p:item stringValue="project.simpleRoleMapper.userRoles"/>
                    <L7p:item stringValue="project.simpleRoleMapper.users"/>
                    <L7p:item stringValue="project.simpleRoleMapping.defaultRole"/>
                    <L7p:item stringValue="project.swaggerCacheExpiry"/>
                    <L7p:item stringValue="project.swaggerDocumentRoot"/>
                    <L7p:item stringValue="project.version"/>
                </L7p:ExportedVars>
            </L7p:ExportVariables>
            <L7p:assertionComment>
                <L7p:Properties mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="RIGHT.COMMENT"/>
                        <L7p:value stringValue="// LAC-00-ProjectConfiguration"/>
                    </L7p:entry>
                </L7p:Properties>
            </L7p:assertionComment>
        </wsp:All>
        <wsp:All wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="LAC-PolicyType=inject"/>
            </L7p:CommentAssertion>
            <wsp:All wsp:Usage="Required">
                <wsp:OneOrMore wsp:Usage="Required">
                    <L7p:SslAssertion/>
                    <wsp:All wsp:Usage="Required">
                        <L7p:CustomizeErrorResponse>
                            <L7p:Content stringValueReference="inline"><![CDATA[{
	"statusCode": "500",
	"errorCode": "000",
	"errorMessage": "SSL required. Use HTTPS instead of HTTP to access this API",
	"helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                            <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                            <L7p:ExtraHeaders nameValuePairArray="included"/>
                        </L7p:CustomizeErrorResponse>
                        <L7p:FalseAssertion/>
                    </wsp:All>
                </wsp:OneOrMore>
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:HttpBasic/>
                        <L7p:Authentication>
                            <L7p:IdentityProviderOid goidValue="0000000000000000fffffffffffffffe"/>
                        </L7p:Authentication>
                        <L7p:IdentityAttributes>
                            <L7p:IdentityProviderOid goidValue="0000000000000000fffffffffffffffe"/>
                            <L7p:LookupAttributes identityMappingArray="included">
                                <L7p:item internalAttributeMapping="included">
                                    <L7p:AttributeConfig attributeConfig="included">
                                    <L7p:Header header="included">
                                    <L7p:Name stringValue="User Login"/>
                                    <L7p:Type variableDataType="string"/>
                                    <L7p:UsersOrGroups usersOrGroups="USERS"/>
                                    <L7p:VariableName stringValue="login"/>
                                    </L7p:Header>
                                    <L7p:VariableName stringValue="login"/>
                                    </L7p:AttributeConfig>
                                    <L7p:ProviderOid goidValue="0000000000000000fffffffffffffffe"/>
                                </L7p:item>
                            </L7p:LookupAttributes>
                        </L7p:IdentityAttributes>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:SslAssertion>
                            <L7p:RequireClientAuthentication booleanValue="true"/>
                        </L7p:SslAssertion>
                        <L7p:CertificateAttributes/>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:CustomizeErrorResponse>
                            <L7p:Content stringValueReference="inline"><![CDATA[{
	"statusCode": "401",
	"errorCode": "000",
	"errorMessage": "Unauthorized",
	"helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                            <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                            <L7p:ExtraHeaders nameValuePairArray="included"/>
                            <L7p:HttpStatus stringValue="401"/>
                        </L7p:CustomizeErrorResponse>
                        <L7p:FalseAssertion/>
                    </wsp:All>
                </wsp:OneOrMore>
            </wsp:All>
            <L7p:ExportVariables>
                <L7p:ExportedVars stringArrayValue="included">
                    <L7p:item stringValue="authenticatedUser.login"/>
                    <L7p:item stringValue="certificate.subject"/>
                    <L7p:item stringValue="certificate.subject.dn"/>
                </L7p:ExportedVars>
            </L7p:ExportVariables>
            <L7p:assertionComment>
                <L7p:Properties mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="RIGHT.COMMENT"/>
                        <L7p:value stringValue="// LAC-01-BasicAuthentication"/>
                    </L7p:entry>
                </L7p:Properties>
            </L7p:assertionComment>
        </wsp:All>
        <wsp:All L7p:Enabled="false" wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="LAC-PolicyType=inject"/>
            </L7p:CommentAssertion>
            <wsp:OneOrMore wsp:Usage="Required">
                <L7p:CacheLookup>
                    <L7p:CacheEntryKey stringValue="${project.serviceSwaggerURL}"/>
                    <L7p:CacheId stringValue="swaggerCache"/>
                    <L7p:ContentTypeOverride stringValue=""/>
                    <L7p:MaxEntryAgeSeconds stringValue="${project.swaggerCacheExpiry}"/>
                    <L7p:OtherTargetMessageVariable stringValue="swaggerDoc"/>
                    <L7p:Target target="OTHER"/>
                </L7p:CacheLookup>
                <wsp:All wsp:Usage="Required">
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:AddHeader>
                                <L7p:HeaderName stringValue="Forwarded"/>
                                <L7p:HeaderValue stringValue="${project.gateway.forwardedHeaderValues}"/>
                                <L7p:RemoveExisting booleanValue="true"/>
                            </L7p:AddHeader>
                            <L7p:HttpRoutingAssertion>
                                <L7p:FollowRedirects booleanValue="true"/>
                                <L7p:HttpMethod httpMethod="GET"/>
                                <L7p:ProtectedServiceUrl stringValue="${project.serviceSwaggerURL}"/>
                                <L7p:ProxyPassword stringValueNull="null"/>
                                <L7p:ProxyUsername stringValueNull="null"/>
                                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:RequestHeaderRules>
                                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included"/>
                                </L7p:RequestParamRules>
                                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                    <L7p:ForwardAll booleanValue="true"/>
                                    <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                    </L7p:Rules>
                                </L7p:ResponseHeaderRules>
                                <L7p:ResponseMsgDest stringValue="swaggerDoc"/>
                            </L7p:HttpRoutingAssertion>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:AuditDetailAssertion>
                                <L7p:Detail stringValue="Swagger URL: ${project.serviceSwaggerURL}"/>
                                <L7p:Level stringValue="FINE"/>
                            </L7p:AuditDetailAssertion>
                            <L7p:CustomizeErrorResponse>
                                <L7p:Content stringValueReference="inline"><![CDATA[{
	"statusCode": "500",
	"errorCode": "000",
	"errorMessage": "Unable to obtain Swagger Document",
	"helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                                <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                                <L7p:ExtraHeaders nameValuePairArray="included"/>
                            </L7p:CustomizeErrorResponse>
                            <L7p:FalseAssertion/>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <wsp:All wsp:Usage="Required">
                        <L7p:ComparisonAssertion>
                            <L7p:Expression1 stringValue="${httpRouting.reasonCode}"/>
                            <L7p:Expression2 stringValue="200"/>
                            <L7p:Predicates predicates="included">
                                <L7p:item binary="included">
                                    <L7p:RightValue stringValue="200"/>
                                </L7p:item>
                            </L7p:Predicates>
                        </L7p:ComparisonAssertion>
                        <L7p:CacheStorage>
                            <L7p:CacheEntryKey stringValue="${project.serviceSwaggerURL}"/>
                            <L7p:CacheId stringValue="swaggerCache"/>
                            <L7p:MaxEntries stringValue="1"/>
                            <L7p:MaxEntryAgeSeconds stringValue="${project.swaggerCacheExpiry}"/>
                            <L7p:MaxEntrySizeBytes stringValue="1000000"/>
                            <L7p:OtherTargetMessageVariable stringValue="swaggerDoc"/>
                            <L7p:Target target="OTHER"/>
                        </L7p:CacheStorage>
                    </wsp:All>
                </wsp:All>
            </wsp:OneOrMore>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:Regex>
                        <L7p:AutoTarget booleanValue="false"/>
                        <L7p:CaseInsensitive booleanValue="true"/>
                        <L7p:IncludeEntireExpressionCapture booleanValue="false"/>
                        <L7p:OtherTargetMessageVariable stringValue="request.http.uri"/>
                        <L7p:Regex stringValue="^.*/@docs$"/>
                        <L7p:RegexName stringValue="Swagger Document Request"/>
                        <L7p:Replacement stringValue=""/>
                        <L7p:Target target="OTHER"/>
                    </L7p:Regex>
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${request.http.method}"/>
                        <L7p:Expression2 stringValue="GET"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item binary="included">
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:RightValue stringValue="GET"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:HardcodedResponse>
                        <L7p:Base64ResponseBody stringValue="JHtzd2FnZ2VyRG9jfQ=="/>
                        <L7p:EarlyResponse booleanValue="true"/>
                        <L7p:ResponseContentType stringValue="application/json"/>
                    </L7p:HardcodedResponse>
                </wsp:All>
                <wsp:All wsp:Usage="Required">
                    <wsp:OneOrMore wsp:Usage="Required">
                        <L7p:Swagger>
                            <L7p:SwaggerDoc stringValue="swaggerDoc"/>
                        </L7p:Swagger>
                        <wsp:All wsp:Usage="Required">
                            <L7p:CustomizeErrorResponse>
                                <L7p:Content stringValueReference="inline"><![CDATA[{
  "statusCode": "500",
  "errorCode": "000",
  "errorMessage": "Swagger Validation Failure",
  "helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                                <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                                <L7p:ExtraHeaders nameValuePairArray="included"/>
                            </L7p:CustomizeErrorResponse>
                            <L7p:FalseAssertion/>
                        </wsp:All>
                    </wsp:OneOrMore>
                </wsp:All>
            </wsp:OneOrMore>
            <L7p:ExportVariables>
                <L7p:ExportedVars stringArrayValue="included">
                    <L7p:item stringValue="sw.apiUri"/>
                    <L7p:item stringValue="sw.baseUri"/>
                    <L7p:item stringValue="sw.host"/>
                    <L7p:item stringValue="swaggerDoc"/>
                </L7p:ExportedVars>
            </L7p:ExportVariables>
            <L7p:assertionComment>
                <L7p:Properties mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="RIGHT.COMMENT"/>
                        <L7p:value stringValue="// LAC-02-ValidateSwagger"/>
                    </L7p:entry>
                </L7p:Properties>
            </L7p:assertionComment>
        </wsp:All>
        <wsp:All wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="LAC-PolicyType=inject"/>
            </L7p:CommentAssertion>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:Expression1 stringValue="${project.roleMappingType}"/>
                        <L7p:Expression2 stringValue="simple"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item binary="included">
                                <L7p:RightValue stringValue="simple"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:SchemaValidation>
                                <L7p:OtherTargetMessageVariable stringValue="project.simpleRoleMapper.users"/>
                                <L7p:ResourceInfo staticResourceInfo="included">
                                    <L7p:Document stringValueReference="inline"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="users">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="user" maxOccurs="unbounded" minOccurs="1">
          <xs:complexType mixed="true">
            <xs:sequence>
              <xs:element type="xs:string" name="group" maxOccurs="unbounded" minOccurs="1"/>
            </xs:sequence>
            <xs:attribute type="xs:string" name="id" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema>]]></L7p:Document>
                                </L7p:ResourceInfo>
                                <L7p:Target target="OTHER"/>
                            </L7p:SchemaValidation>
                            <L7p:SchemaValidation>
                                <L7p:OtherTargetMessageVariable stringValue="project.simpleRoleMapper.userRoles"/>
                                <L7p:ResourceInfo staticResourceInfo="included">
                                    <L7p:Document stringValueReference="inline"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="userRoles">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="userRole" maxOccurs="unbounded" minOccurs="1">
          <xs:complexType>
            <xs:sequence>
              <xs:element type="xs:string" name="role" maxOccurs="unbounded" minOccurs="1"/>
            </xs:sequence>
            <xs:attribute type="xs:string" name="group" use="required"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema>]]></L7p:Document>
                                </L7p:ResourceInfo>
                                <L7p:Target target="OTHER"/>
                            </L7p:SchemaValidation>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Ensure Groups and RoleMapping Messages are valid"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:CustomizeErrorResponse>
                                <L7p:Content stringValueReference="inline"><![CDATA[{
  "statusCode": "500",
  "errorCode": "000",
  "errorMessage": "Simple Role Mapper Misconfigured",
  "helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                                <L7p:ExtraHeaders nameValuePairArray="included"/>
                            </L7p:CustomizeErrorResponse>
                            <L7p:FalseAssertion/>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <wsp:OneOrMore wsp:Usage="Required">
                                <wsp:All wsp:Usage="Required">
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="L3VzZXJzL3VzZXJbQGlkPScke2F1dGhlbnRpY2F0ZWRVc2VyLmxvZ2lufSddL2dyb3Vw"/>
                                    <L7p:VariableToSet stringValue="xpathUser"/>
                                    </L7p:SetVariable>
                                    <L7p:ResponseXpathAssertion>
                                    <L7p:VariablePrefix stringValue="userGroups"/>
                                    <L7p:XmlMsgSrc stringValue="project.simpleRoleMapper.users"/>
                                    <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="${xpathUser}"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                    </L7p:XpathExpression>
                                    </L7p:ResponseXpathAssertion>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxyb2xlTWFwPg0KPGdyb3Vwcz4ke3VzZXJHcm91cHMuZWxlbWVudHN9PC9ncm91cHM+DQoke3Byb2plY3Quc2ltcGxlUm9sZU1hcHBlci51c2VyUm9sZXMubWFpbnBhcnR9DQo8L3JvbGVNYXA+"/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="roleMap"/>
                                    </L7p:SetVariable>
                                    <L7p:XslTransformation>
                                    <L7p:Direction intValue="-1"/>
                                    <L7p:OtherTargetMessageVariable stringValue="roleMap"/>
                                    <L7p:ResourceInfo staticResourceInfo="included">
                                    <L7p:Document stringValueReference="inline"><![CDATA[<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes" omit-xml-declaration="yes"/>
 <xsl:template match="/">
     <xsl:variable name="defaultRole" select="project.simpleRoleMapper.defaultRole"/>
    <xsl:for-each select="/*/groups/group">
     <xsl:variable name="groupName">
           <xsl:value-of select="./text()"/>
     </xsl:variable>
        <xsl:choose>
           <xsl:when test="/*/userRoles/userRole/@group = $groupName">
                <role>"<xsl:value-of select="/*/userRoles/userRole[@group=$groupName]/role" separator=", "/>"</role>
           </xsl:when>
           <xsl:otherwise>
                 <role>"<xsl:value-of select="$defaultRole"/>"</role>
           </xsl:otherwise>
      </xsl:choose>        
 </xsl:for-each>
 </xsl:template>
</xsl:stylesheet>]]></L7p:Document>
                                    </L7p:ResourceInfo>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:TransformName stringValue=""/>
                                    <L7p:XsltVersion stringValue="2.0"/>
                                    </L7p:XslTransformation>
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHJvbGVzPiR7cm9sZU1hcC5tYWlucGFydH08L3JvbGVzPg=="/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="roleMap"/>
                                    </L7p:SetVariable>
                                </wsp:All>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHJvbGVzPjxyb2xlPiIke3Byb2plY3Quc2ltcGxlUm9sZU1hcHBpbmcuZGVmYXVsdFJvbGV9Ijwvcm9sZT48L3JvbGVzPg=="/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="roleMap"/>
                                </L7p:SetVariable>
                            </wsp:OneOrMore>
                            <L7p:ResponseXpathAssertion>
                                <L7p:VariablePrefix stringValue="userRoles"/>
                                <L7p:XmlMsgSrc stringValue="roleMap"/>
                                <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/roles/role"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                </L7p:XpathExpression>
                            </L7p:ResponseXpathAssertion>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Map the Authenticated Users' Groups to the corresponding LAC Roles."/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:CustomizeErrorResponse>
                                <L7p:Content stringValueReference="inline"><![CDATA[{
  "statusCode": "500",
  "errorCode": "000",
  "errorMessage": "Simple Role Mapper Failure",
  "helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                                <L7p:ExtraHeaders nameValuePairArray="included"/>
                            </L7p:CustomizeErrorResponse>
                            <L7p:FalseAssertion/>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="eyJ1c2VySWRlbnRpZmllciI6ICIke2F1dGhlbnRpY2F0ZWRVc2VyLmxvZ2lufSIsICJyb2xlcyI6IFske3VzZXJSb2xlcy5yZXN1bHRzfV0sICJ1c2VyRGF0YSI6IHsibmFtZTEiOiAidmFsMSIsIm5hbWUyIjogInZhbDIifX0="/>
                        <L7p:VariableToSet stringValue="x_ca_gateway_lac_header"/>
                    </L7p:SetVariable>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="X_CA_Gateway_LAC header: ${x_ca_gateway_lac_header}"/>
                        <L7p:Level stringValue="FINE"/>
                    </L7p:AuditDetailAssertion>
                </wsp:All>
                <L7p:TrueAssertion/>
            </wsp:OneOrMore>
            <L7p:ExportVariables>
                <L7p:ExportedVars stringArrayValue="included">
                    <L7p:item stringValue="x_ca_gateway_lac_header"/>
                </L7p:ExportedVars>
            </L7p:ExportVariables>
            <L7p:assertionComment>
                <L7p:Properties mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="RIGHT.COMMENT"/>
                        <L7p:value stringValue="// LAC-03-SimpleRoleMapper"/>
                    </L7p:entry>
                </L7p:Properties>
            </L7p:assertionComment>
        </wsp:All>
        <wsp:All wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="LAC-PolicyType=inject"/>
            </L7p:CommentAssertion>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:Expression1 stringValue="${project.roleMappingType}"/>
                        <L7p:Expression2 stringValue="ldap"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item binary="included">
                                <L7p:RightValue stringValue="ldap"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:OneOrMore wsp:Usage="Required">
                            <wsp:All wsp:Usage="Required">
                                <L7p:ComparisonAssertion>
                                    <L7p:Expression1 stringValue="${authenticatedUser.login}"/>
                                    <L7p:Expression2 stringValue=""/>
                                    <L7p:Negate booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:Negated booleanValue="true"/>
                                    <L7p:Operator operator="EMPTY"/>
                                    <L7p:RightValue stringValue=""/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:LDAPQuery>
                                    <L7p:AllowMultipleResults booleanValue="true"/>
                                    <L7p:AttrNames stringArrayValue="included">
                                    <L7p:item stringValue="memberOf"/>
                                    </L7p:AttrNames>
                                    <L7p:CacheSize intValue="100"/>
                                    <L7p:FailIfNoResults booleanValue="true"/>
                                    <L7p:FailIfTooManyResults booleanValue="true"/>
                                    <L7p:LdapProviderOid goidValue="f8ed6b988ca44f531e7e26c4f72d4c6f"/>
                                    <L7p:MaximumResults intValue="1"/>
                                    <L7p:QueryMappings queryAttributeMappings="included">
                                    <L7p:item mapping="included">
                                    <L7p:AttributeName stringValue="memberOf"/>

                                    <L7p:MatchingContextVariableName stringValue="ldapGroups"/>
                                    <L7p:Multivalued booleanValue="true"/>
                                    </L7p:item>
                                    </L7p:QueryMappings>
                                    <L7p:SearchFilter stringValue="(cn=${authenticatedUser.login})"/>
                                    <L7p:SearchFilterInjectionProtected booleanValue="true"/>
                                </L7p:LDAPQuery>
                                <L7p:ForEachLoop L7p:Usage="Required"
                                    loopVariable="ldapGroups" variablePrefix="userGroups">
                                    <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtncm91cHN9PGdyb3VwPiR7dXNlckdyb3Vwcy5jdXJyZW50fTwvZ3JvdXA+DQo="/>
                                    <L7p:VariableToSet stringValue="groups"/>
                                    </L7p:SetVariable>
                                </L7p:ForEachLoop>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="PHVzZXJzPg0KCTx1c2VyIGlkPSIke2F1dGhlbnRpY2F0ZWRVc2VyLmxvZ2lufSI+DQoJJHtncm91cHN9DQoJPC91c2VyPg0KPC91c2Vycz4="/>
                                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                    <L7p:DataType variableDataType="message"/>
                                    <L7p:VariableToSet stringValue="project.simpleRoleMapper.users"/>
                                </L7p:SetVariable>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Ensure Groups and RoleMapping Messages are valid"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:All>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PHVzZXJzPg0KCTx1c2VyIGlkPSIke2F1dGhlbnRpY2F0ZWRVc2VyLmxvZ2lufSI+DQoJPGdyb3VwPiR7cHJvamVjdC5zaW1wbGVSb2xlTWFwcGluZy5kZWZhdWx0Um9sZX08L2dyb3VwPg0KCTwvdXNlcj4NCjwvdXNlcnM+"/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="project.simpleRoleMapper.users"/>
                            </L7p:SetVariable>
                        </wsp:OneOrMore>
                        <wsp:All wsp:Usage="Required">
                            <L7p:CustomizeErrorResponse>
                                <L7p:Content stringValueReference="inline"><![CDATA[{
  "statusCode": "500",
  "errorCode": "000",
  "errorMessage": "LDAP Role Mapper Query Failure",
  "helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                                <L7p:ExtraHeaders nameValuePairArray="included"/>
                            </L7p:CustomizeErrorResponse>
                            <L7p:FalseAssertion/>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="L3VzZXJzL3VzZXJbQGlkPScke2F1dGhlbnRpY2F0ZWRVc2VyLmxvZ2lufSddL2dyb3Vw"/>
                                <L7p:VariableToSet stringValue="xpathUser"/>
                            </L7p:SetVariable>
                            <L7p:ResponseXpathAssertion>
                                <L7p:VariablePrefix stringValue="userGroups"/>
                                <L7p:XmlMsgSrc stringValue="project.simpleRoleMapper.users"/>
                                <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="${xpathUser}"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                </L7p:XpathExpression>
                            </L7p:ResponseXpathAssertion>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjxyb2xlTWFwPg0KPGdyb3Vwcz4ke3VzZXJHcm91cHMuZWxlbWVudHN9PC9ncm91cHM+DQoke3Byb2plY3Quc2ltcGxlUm9sZU1hcHBlci51c2VyUm9sZXMubWFpbnBhcnR9DQo8L3JvbGVNYXA+"/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="roleMap"/>
                            </L7p:SetVariable>
                            <L7p:XslTransformation>
                                <L7p:Direction intValue="-1"/>
                                <L7p:OtherTargetMessageVariable stringValue="roleMap"/>
                                <L7p:ResourceInfo staticResourceInfo="included">
                                    <L7p:Document stringValueReference="inline"><![CDATA[<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes" omit-xml-declaration="yes"/>
 <xsl:template match="/">
    <xsl:for-each select="/*/groups/group">
     <xsl:variable name="groupName">
           <xsl:value-of select="./text()"/>
     </xsl:variable>
        <xsl:choose>
           <xsl:when test="/*/userRoles/userRole/@group = $groupName">
                <role>"<xsl:value-of select="/*/userRoles/userRole[@group=$groupName]/role" separator=", "/>"</role>
           </xsl:when>
           <xsl:otherwise>
                 <role>"<xsl:value-of select="$groupName" separator=","/>"</role>
           </xsl:otherwise>
      </xsl:choose>        
 </xsl:for-each>
 </xsl:template>
</xsl:stylesheet>]]></L7p:Document>
                                </L7p:ResourceInfo>
                                <L7p:Target target="OTHER"/>
                                <L7p:TransformName stringValue=""/>
                                <L7p:XsltVersion stringValue="2.0"/>
                            </L7p:XslTransformation>
                            <L7p:SetVariable>
                                <L7p:Base64Expression stringValue="PHJvbGVzPiR7cm9sZU1hcC5tYWlucGFydH08L3JvbGVzPg=="/>
                                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                                <L7p:DataType variableDataType="message"/>
                                <L7p:VariableToSet stringValue="roleMap"/>
                            </L7p:SetVariable>
                            <L7p:ResponseXpathAssertion>
                                <L7p:VariablePrefix stringValue="userRoles"/>
                                <L7p:XmlMsgSrc stringValue="roleMap"/>
                                <L7p:XpathExpression xpathExpressionValue="included">
                                    <L7p:Expression stringValue="/roles/role"/>
                                    <L7p:Namespaces mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="s"/>
                                    <L7p:value stringValue="http://schemas.xmlsoap.org/soap/envelope/"/>
                                    </L7p:entry>
                                    </L7p:Namespaces>
                                    <L7p:XpathVersion xpathVersion="XPATH_1_0"/>
                                </L7p:XpathExpression>
                            </L7p:ResponseXpathAssertion>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Map the Authenticated Users' Groups to the corresponding LAC Roles."/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <wsp:All wsp:Usage="Required">
                            <L7p:CustomizeErrorResponse>
                                <L7p:Content stringValueReference="inline"><![CDATA[{
  "statusCode": "500",
  "errorCode": "000",
  "errorMessage": "LDAP Role Mapper Failure",
  "helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                                <L7p:ExtraHeaders nameValuePairArray="included"/>
                            </L7p:CustomizeErrorResponse>
                            <L7p:FalseAssertion/>
                        </wsp:All>
                    </wsp:OneOrMore>
                    <L7p:SetVariable>
                        <L7p:Base64Expression stringValue="eyJ1c2VySWRlbnRpZmllciI6ICIke2F1dGhlbnRpY2F0ZWRVc2VyLmxvZ2lufSIsICJyb2xlcyI6IFske3VzZXJSb2xlcy5yZXN1bHRzfV0sICJ1c2VyRGF0YSI6IHsibmFtZTEiOiAidmFsMSIsIm5hbWUyIjogInZhbDIifX0="/>
                        <L7p:VariableToSet stringValue="x_ca_gateway_lac_header"/>
                    </L7p:SetVariable>
                    <L7p:AuditDetailAssertion>
                        <L7p:Detail stringValue="X_CA_Gateway_LAC header: ${x_ca_gateway_lac_header}"/>
                        <L7p:Level stringValue="FINE"/>
                    </L7p:AuditDetailAssertion>
                </wsp:All>
                <L7p:TrueAssertion/>
            </wsp:OneOrMore>
            <L7p:ExportVariables>
                <L7p:ExportedVars stringArrayValue="included">
                    <L7p:item stringValue="x_ca_gateway_lac_header"/>
                </L7p:ExportedVars>
            </L7p:ExportVariables>
            <L7p:assertionComment>
                <L7p:Properties mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="RIGHT.COMMENT"/>
                        <L7p:value stringValue="// LAC-04-LDAPRoleMapper"/>
                    </L7p:entry>
                </L7p:Properties>
            </L7p:assertionComment>
        </wsp:All>
        <wsp:All wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="LAC-PolicyType=inject"/>
            </L7p:CommentAssertion>
            <L7p:EncodeDecode>
                <L7p:SourceVariableName stringValue="x_ca_gateway_lac_header"/>
                <L7p:TargetDataType variableDataType="string"/>
                <L7p:TargetVariableName stringValue="x_ca_gateway_lac_header_b64"/>
                <L7p:TransformType transformType="BASE64_ENCODE"/>
            </L7p:EncodeDecode>
            <L7p:AuditDetailAssertion>
                <L7p:Detail stringValue="X_CA_GATEWAY_LAC Header Values: ${x_ca_gateway_lac_header}"/>
                <L7p:Level stringValue="FINE"/>
            </L7p:AuditDetailAssertion>
            <L7p:AddHeader>
                <L7p:HeaderName stringValue="X-CA-Gateway-LAC"/>
                <L7p:HeaderValue stringValue="${x_ca_gateway_lac_header_b64}"/>
                <L7p:RemoveExisting booleanValue="true"/>
            </L7p:AddHeader>
            <L7p:AuditDetailAssertion>
                <L7p:Detail stringValue="Forwarded Headers Values: ${project.gateway.forwardedHeaderValues}"/>
                <L7p:Level stringValue="FINE"/>
            </L7p:AuditDetailAssertion>
            <L7p:AddHeader>
                <L7p:HeaderName stringValue="Forwarded"/>
                <L7p:HeaderValue stringValue="${project.gateway.forwardedHeaderValues}"/>
                <L7p:RemoveExisting booleanValue="true"/>
            </L7p:AddHeader>
            <L7p:assertionComment>
                <L7p:Properties mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="RIGHT.COMMENT"/>
                        <L7p:value stringValue="// LAC-05-AddAuthHeader"/>
                    </L7p:entry>
                </L7p:Properties>
            </L7p:assertionComment>
        </wsp:All>
        <wsp:All wsp:Usage="Required">
            <L7p:CommentAssertion>
                <L7p:Comment stringValue="LAC-PolicyType=inject"/>
            </L7p:CommentAssertion>
            <wsp:OneOrMore wsp:Usage="Required">
                <wsp:All wsp:Usage="Required">
                    <L7p:ComparisonAssertion>
                        <L7p:CaseSensitive booleanValue="false"/>
                        <L7p:Expression1 stringValue="${sw.baseUri}"/>
                        <L7p:Operator operatorNull="null"/>
                        <L7p:Predicates predicates="included">
                            <L7p:item stringLength="included">
                                <L7p:Max intValue="-1"/>
                                <L7p:Min intValue="1"/>
                            </L7p:item>
                        </L7p:Predicates>
                    </L7p:ComparisonAssertion>
                    <L7p:HttpRoutingAssertion>
                        <L7p:FailOnErrorStatus booleanValue="false"/>
                        <L7p:PassThroughSoapFaults booleanValue="false"/>
                        <L7p:ProtectedServiceUrl stringValue="${request.url.protocol}://${project.endpoint.hostname}:${project.endpoint.port}/${project.rootPath}${sw.baseUri}${sw.apiUri}${request.url.query}"/>
                        <L7p:ProxyPassword stringValueNull="null"/>
                        <L7p:ProxyUsername stringValueNull="null"/>
                        <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                </L7p:item>
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:RequestHeaderRules>
                        <L7p:RequestParamRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included"/>
                        </L7p:RequestParamRules>
                        <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                            <L7p:ForwardAll booleanValue="true"/>
                            <L7p:Rules httpPassthroughRules="included">
                                <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                </L7p:item>
                            </L7p:Rules>
                        </L7p:ResponseHeaderRules>
                        <L7p:SamlAssertionVersion intValue="2"/>
                    </L7p:HttpRoutingAssertion>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="RIGHT.COMMENT"/>
                                <L7p:value stringValue="// Route with ${sw.host} in url"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
                <L7p:HttpRoutingAssertion>
                    <L7p:FailOnErrorStatus booleanValue="false"/>
                    <L7p:ProtectedServiceUrl stringValue="${request.url.protocol}://${project.endpoint.hostname}:${project.endpoint.port}/${project.rootPath}${request.http.uri}${request.url.query}"/>
                    <L7p:ProxyPassword stringValueNull="null"/>
                    <L7p:ProxyUsername stringValueNull="null"/>
                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                        <L7p:ForwardAll booleanValue="true"/>
                        <L7p:Rules httpPassthroughRules="included"/>
                    </L7p:RequestHeaderRules>
                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                        <L7p:ForwardAll booleanValue="true"/>
                        <L7p:Rules httpPassthroughRules="included"/>
                    </L7p:RequestParamRules>
                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                        <L7p:ForwardAll booleanValue="true"/>
                        <L7p:Rules httpPassthroughRules="included">
                            <L7p:item httpPassthroughRule="included">
                                <L7p:Name stringValue="Set-Cookie"/>
                            </L7p:item>
                        </L7p:Rules>
                    </L7p:ResponseHeaderRules>
                    <L7p:SamlAssertionVersion intValue="2"/>
                </L7p:HttpRoutingAssertion>
                <wsp:All wsp:Usage="Required">
                    <wsp:OneOrMore wsp:Usage="Required">
                        <wsp:All wsp:Usage="Required">
                            <L7p:ComparisonAssertion>
                                <L7p:CaseSensitive booleanValue="false"/>
                                <L7p:Expression1 stringValue="${httpRouting.reasonCode}"/>
                                <L7p:Expression2 stringValue="500"/>
                                <L7p:Operator operator="GT"/>
                                <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Operator operator="GT"/>
                                    <L7p:RightValue stringValue="500"/>
                                    </L7p:item>
                                </L7p:Predicates>
                            </L7p:ComparisonAssertion>
                            <L7p:CustomizeErrorResponse>
                                <L7p:AssertionComment assertionComment="included">
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// 500 (application/json)"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:AssertionComment>
                                <L7p:Content stringValueReference="inline"><![CDATA[{
	"statusCode": "500",
	"errorCode": "000",
	"errorMessage": "Internal Server Error",
	"helpUrl": "http://${project.helpUrl.endpoint.hostname}/support/errors/error000"
}]]></L7p:Content>
                                <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                                <L7p:ExtraHeaders nameValuePairArray="included"/>
                            </L7p:CustomizeErrorResponse>
                            <L7p:assertionComment>
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// ${httpRouting.reasonCode} > 500"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:assertionComment>
                        </wsp:All>
                        <L7p:CustomizeErrorResponse>
                            <L7p:AssertionComment assertionComment="included">
                                <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// ${httpRouting.reasonCode} (application/json) with response"/>
                                    </L7p:entry>
                                </L7p:Properties>
                            </L7p:AssertionComment>
                            <L7p:Content stringValue="${response.mainpart}"/>
                            <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                            <L7p:ExtraHeaders nameValuePairArray="included"/>
                            <L7p:HttpStatus stringValue="${httpRouting.reasonCode}"/>
                        </L7p:CustomizeErrorResponse>
                        <L7p:assertionComment>
                            <L7p:Properties mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="// Fail 500"/>
                                </L7p:entry>
                            </L7p:Properties>
                        </L7p:assertionComment>
                    </wsp:OneOrMore>
                    <L7p:FalseAssertion/>
                    <L7p:assertionComment>
                        <L7p:Properties mapValue="included">
                            <L7p:entry>
                                <L7p:key stringValue="RIGHT.COMMENT"/>
                                <L7p:value stringValue="// Fail"/>
                            </L7p:entry>
                        </L7p:Properties>
                    </L7p:assertionComment>
                </wsp:All>
            </wsp:OneOrMore>
            <L7p:assertionComment>
                <L7p:Properties mapValue="included">
                    <L7p:entry>
                        <L7p:key stringValue="RIGHT.COMMENT"/>
                        <L7p:value stringValue="// LAC-06-BasicRouting"/>
                    </L7p:entry>
                </L7p:Properties>
            </L7p:assertionComment>
        </wsp:All>
    </wsp:All>
</wsp:Policy>