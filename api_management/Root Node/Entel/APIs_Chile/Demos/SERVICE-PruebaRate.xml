<?xml version="1.0" encoding="UTF-8"?>
<wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <wsp:All wsp:Usage="Required">
        <wsp:OneOrMore wsp:Usage="Required">
            <wsp:All wsp:Usage="Required">
                <L7p:RateLimit>
                    <L7p:CounterName stringValue="PRESET(1e788a9a0bfe273d)${request.clientid}"/>
                    <L7p:MaxRequestsPerSecond stringValue="4"/>
                </L7p:RateLimit>
                <L7p:TrueAssertion/>
            </wsp:All>
            <wsp:All wsp:Usage="Required">
                <L7p:CustomizeErrorResponse>
                    <L7p:Content stringValueReference="inline"><![CDATA[{
"result":{
	"transactionId":"123456",
	"code":"429",
	"description":"Solicitud excede el limite de TPS",
	"descriptionDetail":"Solicitud excede el limite de TPS",
	"responseTimestamp":"2018-06-12"
	}
}]]></L7p:Content>
                    <L7p:ContentType stringValue="application/json; charset=UTF-8"/>
                    <L7p:ExtraHeaders nameValuePairArray="included"/>
                    <L7p:HttpStatus stringValue="429"/>
                </L7p:CustomizeErrorResponse>
                <L7p:RaiseError/>
            </wsp:All>
        </wsp:OneOrMore>
        <L7p:HardcodedResponse>
            <L7p:Base64ResponseBody stringValue="PHJlc3B1ZXN0YT5PSwo8L3Jlc3B1ZXN0YT4="/>
        </L7p:HardcodedResponse>
        <L7p:ThroughputQuota>
            <L7p:CounterName stringValue="PRESET(2ba441c03b6f66d7)${request.authenticateduser.id}-${request.authenticateduser.providerid}"/>
            <L7p:Global booleanValue="true"/>
            <L7p:ReadSynchronous booleanValue="false"/>
            <L7p:Synchronous booleanValue="false"/>
        </L7p:ThroughputQuota>
    </wsp:All>
</wsp:Policy>