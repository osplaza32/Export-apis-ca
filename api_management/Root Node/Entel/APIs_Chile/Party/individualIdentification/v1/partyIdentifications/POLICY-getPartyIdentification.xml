<?xml version="1.0" encoding="UTF-8"?>
<wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <wsp:All wsp:Usage="Required">
        <L7p:AuditDetailAssertion>
            <L7p:Detail stringValue="Policy Fragment: getPartyIdentification"/>
        </L7p:AuditDetailAssertion>
        <wsp:OneOrMore wsp:Usage="Required">
            <wsp:All wsp:Usage="Required">
                <wsp:OneOrMore wsp:Usage="Required">
                    <wsp:All wsp:Usage="Required">
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuaGVhZGVyLnJlcXVlc3RUaW1lc3RhbXB9"/>
                            <L7p:VariableToSet stringValue="requestTimestamp"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="eyJoZWFkZXIiOnsiY2FuYWwiOiJNYXlvcmlzdGFzIiwNCiAgICAgICJpZEFwbGljYWNpb24iOjEyMywNCiAgICAgICJ1c3VhcmlvIjoidXNlcjEiLA0KICAgICAgImlkVHJhbnNhY2Npb25FU0IiOiIxMjMiLA0KICAgICAgImlkVHJhbnNhY2Npb25OZWdvY2lvIjoiMTIzIiwNCiAgICAgICJmZWNoYUluaWNpbyI6IjIwMTUtMDktMDFUMTA6MDA6MDAiLA0KICAgICAgIm5vZG9BZGljaW9uYWwiOiIxMjMifSwNCiAiYm9keSI6eyJudW1lcm9Eb2N1bWVudG8iOiIke3JlcXVlc3QuaHR0cC5wYXJhbWV0ZXIuZG5pfSJ9fQ=="/>
                            <L7p:ContentType stringValue="application/json; charset=utf-8"/>
                            <L7p:DataType variableDataType="message"/>
                            <L7p:VariableToSet stringValue="jsonRequest"/>
                        </L7p:SetVariable>
                        <L7p:AuditDetailAssertion>
                            <L7p:CustomLoggerSuffix stringValue="entel.api.syslog"/>
                            <L7p:Detail stringValue="ID Transaction: ${requestId} Request: ${jsonRequest.mainpart}"/>
                            <L7p:LoggingOnly booleanValue="true"/>
                        </L7p:AuditDetailAssertion>
                        <L7p:HttpRoutingAssertion>
                            <L7p:FailOnErrorStatus booleanValue="false"/>
                            <L7p:HttpMethod httpMethod="POST"/>
                            <L7p:ProtectedServiceUrl stringValue="http://${gateway.legado.pe.hostname}/AppMayorista/v2/gestionReniec/consultarDatosReniec"/>
                            <L7p:ProxyPassword stringValueNull="null"/>
                            <L7p:ProxyUsername stringValueNull="null"/>
                            <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                                <L7p:ForwardAll booleanValue="true"/>
                                <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Cookie"/>
                                    </L7p:item>
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="SOAPAction"/>
                                    </L7p:item>
                                </L7p:Rules>
                            </L7p:RequestHeaderRules>
                            <L7p:RequestMsgSrc stringValue="jsonRequest"/>
                            <L7p:RequestParamRules httpPassthroughRuleSet="included">
                                <L7p:ForwardAll booleanValue="true"/>
                                <L7p:Rules httpPassthroughRules="included"/>
                            </L7p:RequestParamRules>
                            <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                                <L7p:ForwardAll booleanValue="true"/>
                                <L7p:Rules httpPassthroughRules="included">
                                    <L7p:item httpPassthroughRule="included">
                                    <L7p:Name stringValue="Set-Cookie"/>
                                    </L7p:item>
                                </L7p:Rules>
                            </L7p:ResponseHeaderRules>
                            <L7p:ResponseMsgDest stringValue="serviceResponse"/>
                        </L7p:HttpRoutingAssertion>
                        <L7p:AuditDetailAssertion>
                            <L7p:CustomLoggerSuffix stringValue="entel.api.syslog"/>
                            <L7p:Detail stringValue="ID Transaction: ${requestId} ReasonCode: ${httpRouting.reasonCode} Response: ${serviceResponse.mainpart}"/>
                            <L7p:LoggingOnly booleanValue="true"/>
                        </L7p:AuditDetailAssertion>
                        <wsp:OneOrMore wsp:Usage="Required">
                            <wsp:All wsp:Usage="Required">
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${httpRouting.reasonCode}"/>
                                    <L7p:Expression2 stringValue="200"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="200"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseStatus.estado"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="estado"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${estado.result}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="0"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseStatus.codigoRespuesta"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="codigoRespuesta"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${codigoRespuesta.result}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="0"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseData.personaReniec.primerApellido"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="individualLastName"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseData.personaReniec.nombres"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="individualFirstName"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseData.personaReniec.segundoApellido"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="segundoApellido"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseData.personaReniec.direccionReniec.codigoDepartamento"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="codigoDepartamento"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseData.personaReniec.direccionReniec.codigoDistrito"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="codigoDistrito"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseData.personaReniec.direccionReniec.codigoProvincia"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="codigoProvincia"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseData.personaReniec.direccionReniec.direccionCompleta"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="direccionCompleta"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnRpbWUubG9jYWwueXl5eS1NTS1kZCdUJ0hIOm1tOnNzLlNTU30="/>
                                    <L7p:VariableToSet stringValue="responseTimestamp"/>
                                </L7p:SetVariable>
                                <L7p:HardcodedResponse>
                                    <L7p:Base64ResponseBody stringValue="ewogICJyZXN1bHQiOiB7CiAgICAiY29kZSI6ICIke2h0dHBSb3V0aW5nLnJlYXNvbkNvZGV9IiwKICAgICJkZXNjcmlwdGlvbiI6ICJPSyIsCiAgICAiZGVzY3JpcHRpb25EZXRhaWwiOiAiUHJvY2VzYW1pZW50byBjb25jbHVpZG8gZXhpdG9zYW1lbnRlIiwKICAgICJyZXNwb25zZVRpbWVzdGFtcCI6ICIke3Jlc3BvbnNlVGltZXN0YW1wfSIsCiAgICAidHJhbnNhY3Rpb25JZCI6ICAiJHtyZXF1ZXN0SWR9IgogIH0sCiAgIkluZGl2aWR1YWxJZGVudGlmaWNhdGlvbiI6IHsKICAgICJmaXJzdE5hbWUiOiAiJHtpbmRpdmlkdWFsRmlyc3ROYW1lLnJlc3VsdH0iLAogICAgImxhc3ROYW1lIjogIiR7aW5kaXZpZHVhbExhc3ROYW1lLnJlc3VsdH0iLAogICAgIm1haWRlbk5hbWUiOiAiJHtzZWd1bmRvQXBlbGxpZG8ucmVzdWx0fSIsCiAgICAiY29kaWdvRGVwYXJ0YW1lbnRvIjogIiR7Y29kaWdvRGVwYXJ0YW1lbnRvLnJlc3VsdH0iLAogICAgImNvZGlnb1Byb3ZpbmNpYSI6ICIke2NvZGlnb1Byb3ZpbmNpYS5yZXN1bHR9IiwKICAgICJjb2RpZ29EaXN0cml0byI6ICIke2NvZGlnb0Rpc3RyaXRvLnJlc3VsdH0iLAogICAgImRpcmVjY2lvbkNvbXBsZXRhIjogIiR7ZGlyZWNjaW9uQ29tcGxldGEucmVzdWx0fSIKICB9Cn0="/>
                                    <L7p:ResponseContentType stringValue="application/json; charset=UTF-8"/>
                                </L7p:HardcodedResponse>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="OK"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:All>
                            <wsp:All wsp:Usage="Required">
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseStatus.estado"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="estado"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:ComparisonAssertion>
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:Expression1 stringValue="${estado.result}"/>
                                    <L7p:Operator operatorNull="null"/>
                                    <L7p:Predicates predicates="included">
                                    <L7p:item dataType="included">
                                    <L7p:Type variableDataType="string"/>
                                    </L7p:item>
                                    <L7p:item binary="included">
                                    <L7p:CaseSensitive booleanValue="false"/>
                                    <L7p:RightValue stringValue="0"/>
                                    </L7p:item>
                                    </L7p:Predicates>
                                </L7p:ComparisonAssertion>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseStatus.codigoRespuesta"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="codigoRespuesta"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseStatus.descripcionRespuesta"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="descriptcionRespuesta"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="NDIy"/>
                                    <L7p:VariableToSet stringValue="httpCode"/>
                                </L7p:SetVariable>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtjb2RpZ29SZXNwdWVzdGEucmVzdWx0fQ=="/>
                                    <L7p:VariableToSet stringValue="code"/>
                                </L7p:SetVariable>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="RXJyb3IgZGUgTmVnb2Npbw=="/>
                                    <L7p:VariableToSet stringValue="description"/>
                                </L7p:SetVariable>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtkZXNjcmlwdGNpb25SZXNwdWVzdGEucmVzdWx0fQ=="/>
                                    <L7p:VariableToSet stringValue="descriptionDetail"/>
                                </L7p:SetVariable>
                                <L7p:RaiseError/>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Warning"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:All>
                            <wsp:All wsp:Usage="Required">
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseStatus.codigoRespuesta"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="codigoRespuesta"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:EvaluateJsonPathExpression>
                                    <L7p:Expression stringValue=".body.responseStatus.descripcionRespuesta"/>
                                    <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                                    <L7p:Target target="OTHER"/>
                                    <L7p:VariablePrefix stringValue="descriptcionRespuesta"/>
                                </L7p:EvaluateJsonPathExpression>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="NTAw"/>
                                    <L7p:VariableToSet stringValue="httpCode"/>
                                </L7p:SetVariable>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="NTAw"/>
                                    <L7p:VariableToSet stringValue="code"/>
                                </L7p:SetVariable>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="SW50ZXJuYWwgU2VydmVyIEVycm9y"/>
                                    <L7p:VariableToSet stringValue="description"/>
                                </L7p:SetVariable>
                                <L7p:SetVariable>
                                    <L7p:Base64Expression stringValue="JHtkZXNjcmlwdGNpb25SZXNwdWVzdGEucmVzdWx0fQ=="/>
                                    <L7p:VariableToSet stringValue="descriptionDetail"/>
                                </L7p:SetVariable>
                                <L7p:RaiseError/>
                                <L7p:assertionComment>
                                    <L7p:Properties mapValue="included">
                                    <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Error"/>
                                    </L7p:entry>
                                    </L7p:Properties>
                                </L7p:assertionComment>
                            </wsp:All>
                        </wsp:OneOrMore>
                        <L7p:assertionComment>
                            <L7p:Properties mapValue="included">
                                <L7p:entry>
                                    <L7p:key stringValue="RIGHT.COMMENT"/>
                                    <L7p:value stringValue="Postpago"/>
                                </L7p:entry>
                            </L7p:Properties>
                        </L7p:assertionComment>
                    </wsp:All>
                    <wsp:All wsp:Usage="Required">
                        <L7p:Encapsulated>
                            <L7p:EncapsulatedAssertionConfigGuid stringValue="14295f18-da19-4f0e-9643-a8c30b3544dc"/>
                            <L7p:EncapsulatedAssertionConfigName stringValue="CodeStatus"/>
                        </L7p:Encapsulated>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtodHRwUm91dGluZy5yZWFzb25Db2RlfQ=="/>
                            <L7p:VariableToSet stringValue="code"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="NTAw"/>
                            <L7p:VariableToSet stringValue="httpCode"/>
                        </L7p:SetVariable>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtjb2RlRGVzY3JpcHRpb259"/>
                            <L7p:VariableToSet stringValue="description"/>
                        </L7p:SetVariable>
                        <L7p:EvaluateJsonPathExpression>
                            <L7p:Expression stringValue=".SourceError.description"/>
                            <L7p:OtherTargetMessageVariable stringValue="serviceResponse"/>
                            <L7p:Target target="OTHER"/>
                        </L7p:EvaluateJsonPathExpression>
                        <L7p:SetVariable>
                            <L7p:Base64Expression stringValue="JHtqc29uUGF0aC5yZXN1bHR9"/>
                            <L7p:VariableToSet stringValue="descriptionDetail"/>
                        </L7p:SetVariable>
                        <L7p:RaiseError/>
                    </wsp:All>
                    <L7p:Include>
                        <L7p:PolicyGuid stringValue="4149a5c9-f2a5-45cf-ac36-02202909301f"/>
                    </L7p:Include>
                </wsp:OneOrMore>
            </wsp:All>
            <wsp:All wsp:Usage="Required">
                <L7p:Include>
                    <L7p:PolicyGuid stringValue="4149a5c9-f2a5-45cf-ac36-02202909301f"/>
                </L7p:Include>
            </wsp:All>
        </wsp:OneOrMore>
    </wsp:All>
</wsp:Policy>