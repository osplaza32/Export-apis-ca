<?xml version="1.0" encoding="UTF-8"?>
<wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <wsp:All wsp:Usage="Required">
        <wsp:OneOrMore wsp:Usage="Required">
            <wsp:All wsp:Usage="Required">
                <L7p:AuditDetailAssertion>
                    <L7p:Detail stringValue="Policy Fragment: postReserve"/>
                </L7p:AuditDetailAssertion>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuYm9keS5yZXNlcnZlLm1vdmlsfQ=="/>
                    <L7p:Enabled booleanValue="false"/>
                    <L7p:VariableToSet stringValue="movil"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuYm9keS5yZXNlcnZlLnRyYW5zYWN0aW9uSWR9"/>
                    <L7p:Enabled booleanValue="false"/>
                    <L7p:VariableToSet stringValue="transactionId"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuYm9keS5yZXNlcnZlLmFwbGljYWNpb259"/>
                    <L7p:Enabled booleanValue="false"/>
                    <L7p:VariableToSet stringValue="aplicacion"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuYm9keS5yZXNlcnZlLnRpcG9Db250ZW5pZG99"/>
                    <L7p:Enabled booleanValue="false"/>
                    <L7p:VariableToSet stringValue="tipoContenido"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuYm9keS5yZXNlcnZlLnZhbG9yfQ=="/>
                    <L7p:Enabled booleanValue="false"/>
                    <L7p:VariableToSet stringValue="valor"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0Lmh0dHAuYm9keS5yZXNlcnZlLnByb2R1Y3RvfQ=="/>
                    <L7p:Enabled booleanValue="false"/>
                    <L7p:VariableToSet stringValue="producto"/>
                </L7p:SetVariable>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reserve.movil"/>
                    <L7p:VariablePrefix stringValue="sMovil"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reserve.transactionId"/>
                    <L7p:VariablePrefix stringValue="sTransactionId"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reserve.aplicacion"/>
                    <L7p:VariablePrefix stringValue="sAplicacion"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reserve.tipoContenido"/>
                    <L7p:VariablePrefix stringValue="sTipoContenido"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reserve.valor"/>
                    <L7p:VariablePrefix stringValue="sValor"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reserve.producto"/>
                    <L7p:VariablePrefix stringValue="sProducto"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="PHNvYXBlbnY6RW52ZWxvcGUgeG1sbnM6c29hcGVudj0iaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvc29hcC9lbnZlbG9wZS8iIHhtbG5zOnJlcT0iaHR0cDovL3d3dy5lc2EuY29tL0JpbGxpbmcvQWNjb3VudFJlY2VpdmFibGVzL04vcmVzZXJ2YXJDb2Jyb1N0b3JlV1MvcmVxdWVzdCI+DQogICA8c29hcGVudjpIZWFkZXIvPg0KICAgPHNvYXBlbnY6Qm9keT4NCiAgICAgIDxyZXE6cmVzZXJ2YXJSZXF1ZXN0RG9jdW1lbnQ+DQogICAgICAgICA8cmVxOnJlcXVlc3Q+DQogICAgICAgICAgICA8IS0tT3B0aW9uYWw6LS0+DQogICAgICAgICAgICA8cmVxOmhlYWRlckluPg0KICAgICAgICAgICAgICAgPHJlcTphcHBOYW1lPj88L3JlcTphcHBOYW1lPg0KICAgICAgICAgICAgICAgPHJlcTp1c2VyTmFtZT4/PC9yZXE6dXNlck5hbWU+DQogICAgICAgICAgICA8L3JlcTpoZWFkZXJJbj4NCiAgICAgICAgICAgIDxyZXE6bW92aWw+JHtzTW92aWwucmVzdWx0fTwvcmVxOm1vdmlsPg0KICAgICAgICAgICAgPHJlcTp0cmFuc2FjdGlvbklkPiR7c1RyYW5zYWN0aW9uSWQucmVzdWx0fTwvcmVxOnRyYW5zYWN0aW9uSWQ+DQogICAgICAgICAgICA8cmVxOmFwbGljYWNpb24+JHtzQXBsaWNhY2lvbi5yZXN1bHR9PC9yZXE6YXBsaWNhY2lvbj4NCiAgICAgICAgICAgIDxyZXE6dGlwb0NvbnRlbmlkbz4ke3NUaXBvQ29udGVuaWRvLnJlc3VsdH08L3JlcTp0aXBvQ29udGVuaWRvPg0KICAgICAgICAgICAgPHJlcTp2YWxvcj4ke3NWYWxvci5yZXN1bHR9PC9yZXE6dmFsb3I+DQogICAgICAgICAgICA8cmVxOnByb2R1Y3RvPiR7c1Byb2R1Y3RvLnJlc3VsdH08L3JlcTpwcm9kdWN0bz4NCiAgICAgICAgIDwvcmVxOnJlcXVlc3Q+DQogICAgICA8L3JlcTpyZXNlcnZhclJlcXVlc3REb2N1bWVudD4NCiAgIDwvc29hcGVudjpCb2R5Pg0KPC9zb2FwZW52OkVudmVsb3BlPg=="/>
                    <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                    <L7p:DataType variableDataType="message"/>
                    <L7p:VariableToSet stringValue="xmlRequest"/>
                </L7p:SetVariable>
                <L7p:AuditDetailAssertion>
                    <L7p:CustomLoggerSuffix stringValue="entel.api.syslog"/>
                    <L7p:Detail stringValue="IDTRANSACTION: ${transactionId.result} SERVICE: ${request.url} REQUEST: ${request.mainpart}"/>
                    <L7p:LoggingOnly booleanValue="true"/>
                </L7p:AuditDetailAssertion>
                <L7p:HttpRoutingAssertion>
                    <L7p:FailOnErrorStatus booleanValue="false"/>
                    <L7p:HttpMethod httpMethod="POST"/>
                    <L7p:ProtectedServiceUrl stringValue="http://${gateway.legado.hostname}/Billing/AccountReceivables/N/reservarCobroStoreService/reservarCobroStore"/>
                    <L7p:ProxyPassword stringValueNull="null"/>
                    <L7p:ProxyUsername stringValueNull="null"/>
                    <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                        <L7p:ForwardAll booleanValue="true"/>
                        <L7p:Rules httpPassthroughRules="included">
                            <L7p:item httpPassthroughRule="included">
                                <L7p:Name stringValue="Cookie"/>
                            </L7p:item>
                            <L7p:item httpPassthroughRule="included">
                                <L7p:Name stringValue="SOAPAction"/>
                            </L7p:item>
                        </L7p:Rules>
                    </L7p:RequestHeaderRules>
                    <L7p:RequestMsgSrc stringValue="xmlRequest"/>
                    <L7p:RequestParamRules httpPassthroughRuleSet="included">
                        <L7p:ForwardAll booleanValue="true"/>
                        <L7p:Rules httpPassthroughRules="included"/>
                    </L7p:RequestParamRules>
                    <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                        <L7p:ForwardAll booleanValue="true"/>
                        <L7p:Rules httpPassthroughRules="included">
                            <L7p:item httpPassthroughRule="included">
                                <L7p:Name stringValue="Set-Cookie"/>
                            </L7p:item>
                        </L7p:Rules>
                    </L7p:ResponseHeaderRules>
                    <L7p:ResponseMsgDest stringValue="serviceResponse"/>
                    <L7p:SamlAssertionVersion intValue="2"/>
                </L7p:HttpRoutingAssertion>
                <L7p:AuditDetailAssertion>
                    <L7p:CustomLoggerSuffix stringValue="entel.api.syslog"/>
                    <L7p:Detail stringValue="IDTRANSACTION: ${transactionId.result} SERVICE: ${httpRouting.url} REASONCODE: ${httpRouting.reasonCode} RESPONSE: ${serviceResponse.mainpart}"/>
                    <L7p:LoggingOnly booleanValue="true"/>
                </L7p:AuditDetailAssertion>
                <L7p:Include>
                    <L7p:PolicyGuid stringValue="6ca99a73-dddf-4d5c-b579-1b8ff18635d6"/>
                </L7p:Include>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtzZXJ2aWNlUmVzcG9uc2UubWFpbnBhcnR9"/>
                    <L7p:ContentType stringValue="application/json; charset=utf-8"/>
                    <L7p:DataType variableDataType="message"/>
                    <L7p:VariableToSet stringValue="responseBackend"/>
                </L7p:SetVariable>
                <L7p:SetVariable>
                    <L7p:Base64Expression stringValue="JHtyZXF1ZXN0LnRpbWUubG9jYWwueXl5eS1NTS1kZCdUJ0hIOm1tOnNzLlNTU30="/>
                    <L7p:ContentType stringValue="application/json; charset=utf-8"/>
                    <L7p:DataType variableDataType="message"/>
                    <L7p:VariableToSet stringValue="responseTimeStamp"/>
                </L7p:SetVariable>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reservarResponseDocument.response.headerOut.codigo"/>
                    <L7p:OtherTargetMessageVariable stringValue="responseBackend"/>
                    <L7p:Target target="OTHER"/>
                    <L7p:VariablePrefix stringValue="sCodigo"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reservarResponseDocument.response.headerOut.descripcion"/>
                    <L7p:OtherTargetMessageVariable stringValue="responseBackend"/>
                    <L7p:Target target="OTHER"/>
                    <L7p:VariablePrefix stringValue="sDescripcion"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reservarResponseDocument.response.headerOut.fechaOperacion"/>
                    <L7p:OtherTargetMessageVariable stringValue="responseBackend"/>
                    <L7p:Target target="OTHER"/>
                    <L7p:VariablePrefix stringValue="sFechaOperacion"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:EvaluateJsonPathExpression>
                    <L7p:Expression stringValue=".reservarResponseDocument.response.headerOut.idOperacion"/>
                    <L7p:OtherTargetMessageVariable stringValue="responseBackend"/>
                    <L7p:Target target="OTHER"/>
                    <L7p:VariablePrefix stringValue="sIdOperacion"/>
                </L7p:EvaluateJsonPathExpression>
                <L7p:HardcodedResponse>
                    <L7p:Base64ResponseBody stringValue="ewogICJyZXN1bHQiOiB7CiAgICAiY29kZSI6ICIke2h0dHBSb3V0aW5nLnJlYXNvbkNvZGV9IiwKICAgICJkZXNjcmlwdGlvbiI6ICJPSyIsCiAgICAiZGVzY3JpcHRpb25EZXRhaWwiOiAiUmVzcHVlc3RhIEV4aXRvc2EiLAogICAgInJlc3BvbnNlVGltZXN0YW1wIjogIiR7cmVzcG9uc2VUaW1lc3RhbXAucmVzdWx0fSIsCiAgICAidHJhbnNhY3Rpb25JZCI6ICAiJHtyZXF1ZXN0SWR9IgogIH0sCiAgImNvZGlnbyI6ICIke3NDb2RpZ28ucmVzdWx0fSIsCiAgImRlc2NyaXB0aW9uIjogIiR7c0Rlc2NyaXBjaW9uLnJlc3VsdH0iLAogICJmZWNoYU9wZXJhY2lvbiI6ICIke3NGZWNoYU9wZXJhY2lvbi5yZXN1bHR9IiwKICAiaWRPcGVyYWNpb24iOiAiJHtzSWRPcGVyYWNpb24ucmVzdWx0fSIKfQ=="/>
                    <L7p:ResponseContentType stringValue="application/json; charset=utf-8"/>
                </L7p:HardcodedResponse>
            </wsp:All>
            <wsp:All wsp:Usage="Required">
                <L7p:CustomizeErrorResponse>
                    <L7p:ExtraHeaders nameValuePairArray="included"/>
                </L7p:CustomizeErrorResponse>
                <L7p:RaiseError/>
            </wsp:All>
        </wsp:OneOrMore>
    </wsp:All>
</wsp:Policy>